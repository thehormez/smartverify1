<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø±ÙƒØ² Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¯Ø¹ÙˆØ§Øª Ø§Ù„ÙŠØ¯ÙˆÙŠ (V2)</title>
    <style>
        body { font-family: Tahoma, Arial, sans-serif; background-color: #f4f4f9; padding: 20px; }
        .container { max-width: 1200px; margin: 0 auto; background-color: #ffffff; padding: 20px; border-radius: 8px; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        h1 { text-align: center; color: #333; margin-bottom: 20px; }
        h2 { border-bottom: 2px solid #ddd; padding-bottom: 10px; margin-top: 30px; color: #5d7eaf; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 12px; text-align: center; }
        th { background-color: #5d7eaf; color: white; }
        tr:nth-child(even) { background-color: #f9f9f9; }
        button { padding: 8px 15px; margin: 5px; cursor: pointer; border: none; border-radius: 4px; font-weight: bold; transition: background-color 0.3s; }
        .btn-qr { background-color: #00bcd4; color: white; }
        .btn-qr:hover { background-color: #0097a7; }
        .btn-whatsapp { background-color: #25D366; color: white; }
        .btn-whatsapp:hover { background-color: #1DA851; }
        textarea { width: 98%; min-height: 150px; padding: 10px; border: 1px solid #ccc; border-radius: 4px; resize: vertical; margin-bottom: 15px; }
        .placeholder-note { color: #f44336; font-weight: bold; margin-bottom: 15px; display: block; text-align: right; }
    </style>
</head>
<body>

<div class="container">
    <h1>Ù…Ø±ÙƒØ² Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø¯Ø¹ÙˆØ§Øª Ø§Ù„ÙŠØ¯ÙˆÙŠ (V2)</h1>

    <h2>ğŸ–Šï¸ ØªØ¹Ø¯ÙŠÙ„ Ù†Øµ Ø±Ø³Ø§Ù„Ø© Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠØ©</h2>
    <span class="placeholder-note">
        Ù…Ù„Ø§Ø­Ø¸Ø©: ØªØ£ÙƒØ¯ Ù…Ù† ØªØ±Ùƒ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª `{{CONFIRM_LINK}}` Ùˆ `{{DECLINE_LINK}}` ÙƒÙ…Ø§ Ù‡ÙŠ. Ø³ÙŠØªÙ… Ø§Ø³ØªØ¨Ø¯Ø§Ù„Ù‡Ø§ Ø¨Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±Ø© Ø§Ù„ÙØ±ÙŠØ¯Ø© Ù„ÙƒÙ„ Ø¶ÙŠÙ Ø¹Ù†Ø¯ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.
    </span>
    <textarea id="messageTemplate">
Ù…Ø±Ø­Ø¨Ø§Ù‹ #{{GUEST_NAME}}#ØŒ
Ù†ØªØ´Ø±Ù Ø¨Ø¯Ø¹ÙˆØªÙƒÙ… Ù„Ø­Ø¶ÙˆØ±... (Ù…Ø¬Ù…ÙˆØ¹ Ø§Ù„Ø£ÙØ±Ø§Ø¯: #{{COMPANIONS_COUNT}}#).

Ù„Ù„ØªØ£ÙƒÙŠØ¯: {{CONFIRM_LINK}}
Ù„Ù„Ø§Ø¹ØªØ°Ø§Ø±: {{DECLINE_LINK}}

ÙŠØ±Ø¬Ù‰ Ù…Ù„Ø§Ø­Ø¸Ø©: ÙƒÙˆØ¯ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„Ø®Ø§Øµ Ø¨ÙƒÙ… Ù…ÙˆØ¬ÙˆØ¯ ÙÙŠ Ø§Ù„ØµÙˆØ±Ø© Ø§Ù„Ù…Ø±ÙÙ‚Ø©.
    </textarea>

    <h2>ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø¯Ø¹ÙˆÙŠÙ† ÙˆØ¬Ø§Ù‡Ø²ÙŠØ© Ø§Ù„Ø¥Ø±Ø³Ø§Ù„</h2>
    <table>
        <thead>
            <tr>
                <th>Ø§Ø³Ù… Ø§Ù„Ø¶ÙŠÙ</th>
                <th>Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø§ÙÙ‚ÙŠÙ†</th>
                <th>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ</th>
                <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
            </tr>
        </thead>
        <tbody id="guestTableBody">
            </tbody>
    </table>

    <a id="hiddenDownloadLink" style="display: none;"></a>
</div>

<script>
    // ----------------------------------------------------------------------
    // 1. Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯Ø¹ÙˆØ§Øª
    // ----------------------------------------------------------------------
    const guests = [
        {
            id: '1001', 
            name: 'ÙÙ‡Ø¯ Ø§Ù„Ø³Ø§Ù„Ù…', 
            companions: 3, // Ø¬Ø¯ÙŠØ¯: Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø§ÙÙ‚ÙŠÙ†
            phone: '96650XXXXXXX', 
            status: 'Pending', 
            qrImage: 'qr-1001.png', 
            shortConfirmLink: 'https://bit.ly/fahd-c', 
            shortDeclineLink: 'https://bit.ly/fahd-d'
        },
        {
            id: '1002', 
            name: 'Ù†ÙˆØ±Ø© Ø§Ù„Ø¹Ù„ÙŠ', 
            companions: 1, 
            phone: '96655XXXXXXX', 
            status: 'Confirmed', 
            qrImage: 'qr-1002.png',
            shortConfirmLink: 'https://bit.ly/nora-c', 
            shortDeclineLink: 'https://bit.ly/nora-d'
        },
        {
            id: '1003', 
            name: 'Ø®Ø§Ù„Ø¯ Ø§Ù„Ø²Ù‡Ø±Ø§Ù†ÙŠ', 
            companions: 0, 
            phone: '96656XXXXXXX', 
            status: 'Declined', 
            qrImage: 'qr-1003.png', 
            shortConfirmLink: 'https://bit.ly/khaled-c', 
            shortDeclineLink: 'https://bit.ly/khaled-d'
        }
        // Ø£Ø¶Ù Ø§Ù„Ù…Ø²ÙŠØ¯ Ù…Ù† Ø§Ù„Ø¶ÙŠÙˆÙ Ù‡Ù†Ø§...
    ];

    // ----------------------------------------------------------------------
    // 2. ÙˆØ¸Ø§Ø¦Ù JavaScript Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©
    // ----------------------------------------------------------------------

    /**
     * ÙˆØ¸ÙŠÙØ© Ù„ØªØ­Ù…ÙŠÙ„ (ØªÙ†Ø²ÙŠÙ„) ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ Ø§Ù„Ù…Ø®ØµØµØ© Ù…Ø¨Ø§Ø´Ø±Ø©.
     * @param {string} imageName - Ø§Ø³Ù… Ù…Ù„Ù ØµÙˆØ±Ø© Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ (Ù…Ø«Ù„Ø§Ù‹: qr-1001.png).
     */
    function downloadBarcodeImage(imageName) {
        const imagePath = `qr_images/${imageName}`;
        const downloadLink = document.getElementById('hiddenDownloadLink');
        
        // ØªØ¹ÙŠÙŠÙ† Ù…Ø³Ø§Ø± Ø§Ù„Ù…Ù„Ù Ø§Ù„Ù…Ø±Ø§Ø¯ ØªØ­Ù…ÙŠÙ„Ù‡
        downloadLink.href = imagePath;
        // ØªØ¹ÙŠÙŠÙ† Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø°ÙŠ Ø³ÙŠØªÙ… Ø­ÙØ¸Ù‡ Ø¨Ù‡
        downloadLink.download = imageName;
        
        // Ù…Ø­Ø§ÙƒØ§Ø© Ø§Ù„Ù†Ù‚Ø± Ø¹Ù„Ù‰ Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ù…Ø®ÙÙŠ Ù„ØªÙ†ÙÙŠØ° Ø§Ù„ØªØ­Ù…ÙŠÙ„
        downloadLink.click();

        alert(`ØªÙ… Ø¨Ø¯Ø¡ ØªØ­Ù…ÙŠÙ„ Ù…Ù„Ù Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯: ${imageName}. Ø§Ø¨Ø­Ø« Ø¹Ù†Ù‡ ÙÙŠ Ù…Ø¬Ù„Ø¯ Ø§Ù„ØªÙ†Ø²ÙŠÙ„Ø§Øª.`);
    }


    /**
     * ÙˆØ¸ÙŠÙØ© Ù„ÙØªØ­ Ù…Ø­Ø§Ø¯Ø«Ø© ÙˆØ§ØªØ³Ø§Ø¨ Ù…Ø¹ Ø±Ø³Ø§Ù„Ø© Ù…ÙØ¹Ø¯Ù‘ÙØ© Ù…Ø³Ø¨Ù‚Ø§Ù‹ (Ø¨Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù†Øµ Ø§Ù„Ù‚Ø§Ø¨Ù„ Ù„Ù„ØªØ¹Ø¯ÙŠÙ„).
     */
    function sendWhatsAppMessage(guest) {
        // 1. Ø³Ø­Ø¨ Ø§Ù„Ù†Øµ Ø§Ù„Ø­Ø§Ù„ÙŠ Ù…Ù† Ø­Ù‚Ù„ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        let messageText = document.getElementById('messageTemplate').value;

        // 2. Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø§Ù„Ù…ØªØºÙŠØ±Ø§Øª Ø§Ù„Ø®Ø§ØµØ© Ø¨Ø§Ù„Ø¶ÙŠÙ
        messageText = messageText.replace(/#{{GUEST_NAME}}#/g, guest.name);
        messageText = messageText.replace(/#{{COMPANIONS_COUNT}}#/g, guest.companions);
        
        // 3. Ø§Ø³ØªØ¨Ø¯Ø§Ù„ Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØªØ£ÙƒÙŠØ¯ ÙˆØ§Ù„Ø§Ø¹ØªØ°Ø§Ø± Ø¨Ø§Ù„Ø±ÙˆØ§Ø¨Ø· Ø§Ù„Ù‚ØµÙŠØ±Ø©
        messageText = messageText.replace(/{{CONFIRM_LINK}}/g, guest.shortConfirmLink);
        messageText = messageText.replace(/{{DECLINE_LINK}}/g, guest.shortDeclineLink);

        // 4. Ø¥Ù†Ø´Ø§Ø¡ Ø±Ø§Ø¨Ø· Ø§Ù„ÙˆØ§ØªØ³Ø§Ø¨ ÙˆÙØªØ­Ù‡
        const waLink = `https://wa.me/${guest.phone}?text=${encodeURIComponent(messageText)}`;
        window.open(waLink, '_blank');
    }

    // ----------------------------------------------------------------------
    // 3. Ø¹Ø±Ø¶ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ÙÙŠ Ø§Ù„Ø¬Ø¯ÙˆÙ„
    // ----------------------------------------------------------------------
    
    document.addEventListener('DOMContentLoaded', () => {
        const tableBody = document.getElementById('guestTableBody');
        
        guests.forEach(guest => {
            const row = tableBody.insertRow();
            
            // Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø§Ø³Ù… ÙˆØ¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø§ÙÙ‚ÙŠÙ† ÙˆØ±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙˆØ§Ù„Ø­Ø§Ù„Ø©
            row.insertCell().textContent = guest.name;
            row.insertCell().textContent = guest.companions; // Ø¹Ø±Ø¶ Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø±Ø§ÙÙ‚ÙŠÙ†
            row.insertCell().textContent = guest.phone;
            
            const statusCell = row.insertCell();
            statusCell.textContent = guest.status;
            if (guest.status === 'Confirmed') {
                statusCell.style.color = '#4CAF50';
                statusCell.style.fontWeight = 'bold';
            } else if (guest.status === 'Declined') {
                statusCell.style.color = '#f44336';
            }

            // Ø¹Ù…ÙˆØ¯ Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª (Ø§Ù„Ø£Ø²Ø±Ø§Ø±)
            const actionsCell = row.insertCell();

            // Ø²Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ (Ø§Ù„Ø®Ø·ÙˆØ© 1: ØªØ¬Ù‡ÙŠØ² Ø§Ù„ØµÙˆØ±Ø©)
            const qrButton = document.createElement('button');
            qrButton.textContent = '1. ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨Ø§Ø±ÙƒÙˆØ¯ ğŸ’¾';
            qrButton.className = 'btn-qr';
            qrButton.onclick = () => downloadBarcodeImage(guest.qrImage);
            actionsCell.appendChild(qrButton);
            
            // Ø²Ø± Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨ (Ø§Ù„Ø®Ø·ÙˆØ© 2: ÙØªØ­ Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ù†Øµ)
            const waButton = document.createElement('button');
            waButton.textContent = '2. Ø¥Ø±Ø³Ø§Ù„ ÙˆØ§ØªØ³Ø§Ø¨ (Ø§Ù„Ù†Øµ ÙˆØ§Ù„Ø±ÙˆØ§Ø¨Ø·)';
            waButton.className = 'btn-whatsapp';
            // Ù†Ù…Ø±Ø± ÙƒØ§Ø¦Ù† Ø§Ù„Ø¶ÙŠÙ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„ Ù„Ù„ÙˆØ¸ÙŠÙØ©
            waButton.onclick = () => sendWhatsAppMessage(guest);
            actionsCell.appendChild(waButton);
        });
    });

</script>
</body>
</html>
